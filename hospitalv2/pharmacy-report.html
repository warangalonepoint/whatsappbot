
<!doctype html><html lang="en" data-theme="light">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Pharmacy Reports – CSV Demo</title><link rel="stylesheet" href="styles.css"/><script src="js/csv.js"></script></head>
<body><div class="wrap">
<header class="banner"><a class="chip floating-toggle" href="admin.html">← Admin</a></header>
<section class="card"><h2>Sales Summary</h2>
  <div class="row">
    <div class="chip">Today ₹ <b id="t">0.00</b></div>
    <div class="chip">MTD ₹ <b id="m">0.00</b></div>
    <div class="chip">Invoices Today <b id="c">0</b></div>
  </div>
  <table id="tbl"></table>
</section></div>
<script>
function fmt(n){return (Number(n)||0).toFixed(2);} function iso(d){return new Date(d).toISOString().slice(0,10);}
(function(){
  const inv = CsvDB.all('invoices'); const today=iso(new Date()); const month=today.slice(0,7);
  const todays = inv.filter(i=> (i.invoice_date||'').slice(0,10)===today);
  const mtd = inv.filter(i=> (i.invoice_date||'').slice(0,7)===month);
  document.getElementById('t').textContent=fmt(todays.reduce((s,i)=>s+Number(i.total_rs||0),0));
  document.getElementById('m').textContent=fmt(mtd.reduce((s,i)=>s+Number(i.total_rs||0),0));
  document.getElementById('c').textContent=todays.length;
  const rows=[['#','Date','Patient','Total']].concat(inv.map(i=>[i.invoice_no||'',i.invoice_date||'',i.patient_name||'',fmt(i.total_rs||0)]));
  document.getElementById('tbl').innerHTML=rows.map((r,i)=>'<tr>'+r.map(c=>`<${i?'td':'th'}>${c}</${i?'td':'th'}>`).join('')+'</tr>').join('');
})();
</script>
</body></html>
